/* 
 * angular-dribble 0.0.1
 * https://github.com/kirstein/angular-dribble
 * 
 * Licensed under the MIT license
 */
!function(a){"use strict";var b={property:null,timeout:5e3},c=a.module("ngDribble",[]);c.provider("$dribble",function(){var c=b;this.config=function(b){return a.isObject(b)&&a.extend(c,b),c},this.$get=function(){return function(){return c}}}),c.service("ngDribbleService",["$templateCache","$injector","$timeout","$dribble","$filter",function(b,c,d,e,f){function g(){return l=l||c.get("$route"),j=[],a.forEach(l.routes,function(b){a.isString(b.templateUrl)&&j.push({url:b.templateUrl,priority:b[o.property]})}),a.isString(o.property)&&(j=p(j,"priority",!1)),j}function h(){return a.isArray(j)&&!j.length}function i(){var a;if(m=m||c.get("$http"),j=j||g(),j.length){if(a=j.shift().url,n[a]=!1,b.get(a))return n[a]=!0,i();m.get(a,{cache:b})}}var j,k,l,m,n={},o=e(),p=f("orderBy");this.notify=function(a){h()||(n.hasOwnProperty(a)?(n[a]=!0,i()):this.resetTimer())},this.resetTimer=function(){h()||(k&&d.cancel(k),k=d(i,o.timeout,!1))}}]),c.config(["$httpProvider",function(a){a.responseInterceptors.push(["ngDribbleService","$q",function(a,b){function c(b){a.notify(b.config.url)}return function(a){return a.then(function(a){return c(a),a},function(a){return c(a),b.reject(a)})}}])}]),c.run(["ngDribbleService",function(a){a.resetTimer()}])}(angular);